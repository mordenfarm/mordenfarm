
<!DOCTYPE html>
<html lang="en">
<head>
    <!-- SEO & Metadata -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modern Farmer | Expert-Led Online Farming Courses</title>
    <meta name="description" content="Elevate your farming skills with expert-led online courses in broiler rearing, mushroom cultivation, fish farming, and more. Join Modern Farmer to increase your yield and profitability.">
    <meta name="keywords" content="farming courses, agriculture education, broiler chicken, road runner chicken, mushroom farming, fish farming, maize farming, modern agriculture, online learning">
    <meta name="author" content="ALFA OCTAL SYSTEMS">

    <!-- Social Media / Open Graph -->
    <meta property="og:title" content="Modern Farmer | Expert-Led Online Farming Courses">
    <meta property="og:description" content="Elevate your farming skills with expert-led online courses. Increase your yield and profitability today.">
    <meta property="og:image" content="https://your-website-url.com/social-share-image.jpg">
    <meta property="og:url" content="https://your-website-url.com/">
    <meta property="twitter:card" content="summary_large_image">

    <!-- Favicon -->
    <link rel="icon" href="/favicon.ico" sizes="any">
    <link rel="icon" href="/favicon.svg" type="image/svg+xml">
    <link rel="apple-touch-icon" href="/apple-touch-icon.png">

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
    
    <!-- Firebase Configuration (Injected by Netlify) -->
    <script>
      const firebaseConfig = {
        apiKey: "%%FIREBASE_API_KEY%%",
        authDomain: "%%FIREBASE_AUTH_DOMAIN%%",
        projectId: "%%FIREBASE_PROJECT_ID%%",
        storageBucket: "%%FIREBASE_STORAGE_BUCKET%%",
        messagingSenderId: "%%FIREBASE_MESSAGING_SENDER_ID%%",
        appId: "%%FIREBASE_APP_ID%%",
        measurementId: "%%FIREBASE_MEASUREMENT_ID%%"
      };
    </script>

    <!-- Firebase SDKs -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, signInWithPopup, GoogleAuthProvider, signOut, onAuthStateChanged, updateProfile } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
        import { getFirestore, doc, setDoc, getDoc, updateDoc } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';
        try {
            const app = initializeApp(firebaseConfig);
            window.firebase = {
                app, auth: getAuth(app), db: getFirestore(app), googleProvider: new GoogleAuthProvider(),
                signInWithEmailAndPassword, createUserWithEmailAndPassword,
                signInWithPopup, signOut, onAuthStateChanged, updateProfile,
                doc, setDoc, getDoc, updateDoc
            };
            console.log("Firebase initialized successfully.");
        } catch (error) {
            console.error("Firebase initialization failed. Please check your config.", error);
            window.firebase = {};
        }
    </script>

    <style>
        :root {
            --color-primary: #e53935; --color-primary-dark: #c62828;
            --color-secondary: #43a047; --color-secondary-dark: #2e7d32;
            --color-gold: #ffc107; --bg-dark: #121212; --bg-light: #1e1e1e;
            --bg-card: #2a2a2a; --text-primary: #f5f5f5; --text-secondary: #b0b0b0;
            --text-muted: #757575; --border-color: #424242;
            --border-radius-sm: 8px; --border-radius-md: 16px;
            --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.2); --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.3);
            --shadow-lg: 0 8px 30px rgba(0, 0, 0, 0.4); --shadow-primary: 0 4px 20px rgba(229, 57, 53, 0.25);
            --font-primary: 'Inter', sans-serif; --font-display: 'Playfair Display', serif;
            --transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
        }
        *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; }
        body {
            font-family: var(--font-primary); line-height: 1.7;
            background-color: var(--bg-dark); color: var(--text-primary);
            overflow-x: hidden;
        }
        .container { width: 90%; max-width: 1200px; margin: 0 auto; padding: 4rem 0; }
        .visually-hidden { position: absolute; width: 1px; height: 1px; margin: -1px; padding: 0; overflow: hidden; clip: rect(0, 0, 0, 0); border: 0; }
        a { text-decoration: none; color: var(--color-primary); }

        /* --- HEADER STYLES --- */
        .header {
            position: fixed; top: 0; left: 0; width: 100%; height: 80px;
            background: rgba(18, 18, 18, 0.85); backdrop-filter: blur(10px);
            z-index: 1000; display: flex; align-items: center; justify-content: space-between;
            padding: 0 2rem; border-bottom: 1px solid var(--border-color);
        }
        .logo { font-size: 1.5rem; font-weight: 700; color: var(--text-primary); display: flex; align-items: center; gap: 0.75rem; }
        .logo-icon { color: var(--color-primary); }
        .header-right { display: flex; align-items: center; gap: 1.5rem; margin-left: auto; }
        .nav-menu { display: flex; list-style: none; gap: 1.5rem; align-items: center; }
        .nav-menu a { color: var(--text-secondary); font-weight: 600; font-size: 0.9rem; padding: 0.5rem 0; position: relative; }
        .nav-menu a::after { content: ''; position: absolute; bottom: 0; left: 0; width: 0; height: 2px; background: var(--color-primary); transition: var(--transition); }
        .nav-menu a:hover, .nav-menu a.active { color: var(--text-primary); }
        .nav-menu a:hover::after, .nav-menu a.active::after { width: 100%; }
        
        .dropdown { position: relative; }
        .dropdown-content {
            display: none; position: absolute; top: 120%; left: 50%;
            transform: translateX(-50%); background: var(--bg-light); min-width: 220px;
            box-shadow: var(--shadow-md); border-radius: var(--border-radius-sm);
            opacity: 0; visibility: hidden; transition: opacity 0.3s ease, top 0.3s ease;
            z-index: 1001; overflow: hidden; border: 1px solid var(--border-color);
        }
        .dropdown:hover .dropdown-content { display: block; opacity: 1; visibility: visible; top: 100%; }
        .dropdown-content a { display: block; padding: 0.75rem 1.5rem; color: var(--text-secondary); white-space: nowrap; }
        .dropdown-content a:hover { background: rgba(229, 57, 53, 0.1); color: var(--text-primary); }
        .dropdown-content a::after { display: none; }
        
        .user-profile { display: flex; align-items: center; gap: 0.75rem; cursor: pointer; position: relative; }
        .user-avatar { width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; background: var(--color-primary); overflow: hidden; }
        .user-info { display: none; }
        @media (min-width: 992px) { .user-info { display: flex; flex-direction: column; } }
        .user-name { font-size: 0.9rem; font-weight: 600; }
        .user-action-text { font-size: 0.8rem; color: var(--text-secondary); }
        .crown-icon { position: absolute; top: -5px; left: -8px; font-size: 1.2rem; color: var(--color-gold); transform: rotate(-15deg); filter: drop-shadow(0 0 3px rgba(0,0,0,0.8)); }
        
        .hamburger { display: none; background: none; border: none; color: var(--text-primary); font-size: 1.5rem; cursor: pointer; z-index: 1002; }
        .mobile-nav-backdrop { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.5); z-index: 998; }
        .mobile-nav-backdrop.active { display: block; }

        @media (max-width: 992px) {
            .desktop-nav { display: none; }
            .hamburger { display: block; }
            .mobile-nav {
                position: fixed; top: 0; right: -100%; width: min(75vw, 300px); height: 100vh;
                background: var(--bg-light); box-shadow: var(--shadow-lg); transition: right 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
                padding-top: 100px; z-index: 999;
            }
            .mobile-nav.active { right: 0; }
            .mobile-nav .nav-menu { flex-direction: column; align-items: flex-start; gap: 0; width: 100%; }
            .mobile-nav .nav-menu li { width: 100%; }
            .mobile-nav .nav-menu > li > a { display: block; padding: 1rem 2rem; width: 100%; font-size: 1.1rem; }
            .mobile-nav a::after { display: none; }
            .mobile-nav .dropdown-content {
                display: block; position: static; transform: none; box-shadow: none;
                background: var(--bg-dark); max-height: 0; overflow: hidden;
                opacity: 1; visibility: visible; transition: max-height 0.4s ease-in-out;
                padding-left: 1rem; border: none; min-width: auto;
            }
            .mobile-nav .dropdown-content.show { max-height: 500px; }
            .mobile-nav .dropdown-content a { font-size: 1rem; }
        }

        /* --- HERO SLIDER STYLES --- */
        .hero-slider-container { width: 100%; height: 100vh; position: relative; overflow: hidden; }
        .hero-slider-container .slide .item {
            width: 200px; height: 300px; position: absolute; top: 50%;
            transform: translate(0, -50%); border-radius: 20px;
            box-shadow: 0 30px 50px #000; background-position: center;
            background-size: cover; display: inline-block; transition: 0.5s;
        }
        .slide .item:nth-child(1), .slide .item:nth-child(2) {
            top: 0; left: 0; transform: none; border-radius: 0; width: 100%; height: 100%;
        }
        .slide .item:nth-child(2)::before { content: ''; position: absolute; inset: 0; background: rgba(0,0,0,0.5); z-index: 1; }
        .slide .item:nth-child(3) { left: 50%; } .slide .item:nth-child(4) { left: calc(50% + 220px); }
        .slide .item:nth-child(5) { left: calc(50% + 440px); } .slide .item:nth-child(n + 6) { left: calc(50% + 660px); opacity: 0; }
        .item .content {
            position: absolute; top: 50%; left: 100px; width: 90%; max-width: 500px;
            text-align: left; color: #eee; transform: translateY(-50%);
            font-family: var(--font-primary); display: none; z-index: 2;
        }
        .slide .item:nth-child(2) .content { display: block; }
        .content .name {
            font-family: var(--font-display); font-size: clamp(2.5rem, 5vw, 4rem);
            text-transform: uppercase; font-weight: bold; opacity: 0;
            animation: animate 1s ease-in-out 1 forwards;
        }
        .content .des {
            margin: 1rem 0 2rem; opacity: 0; font-size: 1.2rem;
            animation: animate 1s ease-in-out 0.3s 1 forwards;
        }
        .content .cta-button {
            padding: 12px 24px; border: none; cursor: pointer; opacity: 0;
            border-radius: var(--border-radius-sm); background-color: var(--color-primary);
            color: white; font-weight: 600; text-transform: uppercase; font-size: 1rem;
            transition: all 0.5s; animation: animate 1s ease-in-out 0.6s 1 forwards;
        }
        .content .cta-button:hover { background-color: var(--color-primary-dark); transform: scale(1.05); }
        @keyframes animate {
            from { opacity: 0; transform: translateY(100px); filter: blur(20px); }
            to { opacity: 1; transform: translateY(0); filter: blur(0); }
        }
        .slider-button {
            position: absolute; bottom: 40px; left: 50%;
            transform: translateX(-50%); display: flex; gap: 20px; z-index: 10;
        }
        .slider-button button {
            width: 50px; height: 50px; border-radius: 50%; border: 1px solid rgba(255,255,255,0.7);
            cursor: pointer; background: rgba(0,0,0,0.5); color: #fff;
            font-size: 1.2rem; font-weight: bold; transition: 0.3s;
        }
        .slider-button button:hover { background: var(--color-primary); border-color: var(--color-primary); transform: scale(1.1); }
        @media (max-width: 768px) { .item .content { left: 2rem; } .content .name { font-size: 2.5rem; } }

        /* --- ALL OTHER STYLES --- */
        .section-header { text-align: center; margin-bottom: 3rem; }
        .section-header .subtitle { color: var(--color-primary); font-weight: 600; margin-bottom: 0.5rem; text-transform: uppercase; }
        h2 { font-family: var(--font-display); font-size: clamp(2rem, 4vw, 3rem); }

        .course-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 2rem; }
        .course-card {
            background: var(--bg-card); border-radius: var(--border-radius-md); border: 1px solid var(--border-color);
            overflow: hidden; text-decoration: none; color: var(--text-primary); transition: var(--transition);
        }
        .course-card:hover { transform: translateY(-10px); box-shadow: var(--shadow-lg); border-color: var(--color-primary); }
        .card-thumbnail { width: 100%; height: 180px; display: flex; justify-content: center; align-items: center; font-size: 4rem; }
        .card-info { padding: 1.5rem; } .card-info h3 { font-size: 1.3rem; margin-bottom: 0.75rem; }
        .card-info p { color: var(--text-secondary); font-size: 0.95rem; }
        
        #payment-section, .course-page { display: none; } /* JS controlled */
        
        /* Auth Modal, Payment Card, Course Page, Footer, etc. */
        /* Paste remaining CSS from your previous versions here if needed */
        .auth-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.8); backdrop-filter: blur(10px); z-index: 2000; display: flex; align-items: center; justify-content: center; opacity: 0; visibility: hidden; transition: var(--transition); }
        .auth-modal.active { opacity: 1; visibility: visible; }
        .auth-container { background: var(--bg-light); border-radius: var(--border-radius-md); padding: 2.5rem; width: 90%; max-width: 420px; box-shadow: var(--shadow-lg); position: relative; transform: scale(0.95); transition: transform 0.3s ease-out; }
        .auth-modal.active .auth-container { transform: scale(1); }
        .auth-title { font-size: 1.8rem; text-align: center; margin-bottom: 0.5rem; }
        .auth-subtitle { color: var(--text-secondary); text-align: center; margin-bottom: 2rem; }
        .auth-form { display: flex; flex-direction: column; gap: 1rem; }
        .form-input { padding: 1rem; background: var(--bg-dark); border: 1px solid var(--border-color); border-radius: var(--border-radius-sm); color: var(--text-primary); font-size: 1rem; transition: var(--transition); }
        .form-input:focus { outline: none; border-color: var(--color-primary); box-shadow: 0 0 0 3px rgba(229, 57, 53, 0.2); }
        .form-button { padding: 1rem; background: var(--color-primary); color: white; border: none; border-radius: var(--border-radius-sm); font-size: 1rem; font-weight: 600; cursor: pointer; transition: var(--transition); }
        .form-button:hover:not(:disabled) { background: var(--color-primary-dark); transform: translateY(-2px); box-shadow: var(--shadow-primary); }
        .form-button:disabled { opacity: 0.6; cursor: not-allowed; }
        .google-button { background: #fff; color: #333; display: flex; align-items: center; justify-content: center; gap: 0.75rem; }
        .google-button:hover { background: #f5f5f5; }
        .auth-switch { text-align: center; margin-top: 1.5rem; color: var(--text-secondary); }
        .auth-switch-link { color: var(--color-primary); font-weight: 600; }
        .close-button { position: absolute; top: 1rem; right: 1rem; background: none; border: none; color: var(--text-secondary); font-size: 1.8rem; cursor: pointer; transition: var(--transition); }
        .close-button:hover { color: var(--text-primary); }
        .hidden { display: none; }
    </style>
</head>
<body>
    <h1 class="visually-hidden">Modern Farmer: Online Agriculture Courses</h1>
    
    <!-- Auth Modal -->
    <div class="auth-modal" id="authModal">
        <div class="auth-container">
            <button class="close-button" id="closeAuthModal" aria-label="Close authentication modal">&times;</button>
            <div class="auth-header"><h2 class="auth-title" id="authTitle">Welcome Back</h2><p class="auth-subtitle" id="authSubtitle">Sign in to access your courses</p></div>
            <form class="auth-form" id="authForm" novalidate>
                <div class="form-group hidden" id="usernameGroup"><label for="authUsername" class="visually-hidden">Username</label><input class="form-input" type="text" id="authUsername" placeholder="Enter your username"></div>
                <div class="form-group"><label for="authEmail" class="visually-hidden">Email</label><input class="form-input" type="email" id="authEmail" placeholder="Enter your email" required></div>
                <div class="form-group"><label for="authPassword" class="visually-hidden">Password</label><input class="form-input" type="password" id="authPassword" placeholder="Enter your password" required></div>
                <button class="form-button" type="submit" id="authSubmitBtn">Sign In</button>
                <button class="form-button google-button" type="button" id="googleSignInBtn"><svg width="20" height="20" viewBox="0 0 24 24" aria-hidden="true"><path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/><path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/><path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/><path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/></svg> Continue with Google</button>
            </form>
            <div class="auth-switch"><span id="authSwitchText">Don't have an account?</span><a href="#" class="auth-switch-link" id="authSwitchLink">Sign up</a></div>
        </div>
    </div>
    
    <div class="mobile-nav-backdrop" id="mobileNavBackdrop"></div>
    <header class="header" id="page-header">
        <a href="#home-view" class="logo">
            <span class="logo-icon" aria-hidden="true">üå±</span>
            <span>MODERN FARMER</span>
        </a>
        <div class="header-right">
            <nav class="desktop-nav" aria-label="Main Navigation">
                <ul class="nav-menu">
                    <li><a href="#home-view">HOME</a></li>
                    <li class="dropdown">
                        <a href="#courses-section">COURSES &#9662;</a>
                        <div class="dropdown-content">
                            <!-- Populated by JS -->
                        </div>
                    </li>
                    <li><a href="#testimonials-section">TESTIMONIALS</a></li>
                    <li><a href="#contact-section">CONTACT</a></li>
                </ul>
            </nav>
            <div id="auth-section">
                <div class="user-profile" id="userProfile" tabindex="0" aria-label="User profile and login/logout">
                    <div class="user-avatar" id="userAvatar" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg></div>
                    <div class="user-info"><div class="user-name" id="userName">Guest</div><div class="user-action-text" id="userActionText">Login</div></div>
                </div>
            </div>
            <button class="hamburger" id="hamburger" aria-label="Open navigation menu" aria-expanded="false"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></button>
        </div>
    </header>
    
    <nav class="mobile-nav" id="mobileNav" aria-label="Mobile Navigation">
        <ul class="nav-menu">
            <li><a href="#home-view">HOME</a></li>
            <li class="dropdown">
                <a href="#" id="mobileCoursesToggle">COURSES &#9662;</a>
                <div class="dropdown-content">
                    <!-- Populated by JS -->
                </div>
            </li>
            <li><a href="#testimonials-section">TESTIMONIALS</a></li>
            <li><a href="#contact-section">CONTACT</a></li>
        </ul>
    </nav>

    <main>
        <section class="hero-slider-container" id="home-view" aria-label="Featured Courses Showcase">
            <div class="slide">
                <div class="item" style="background-image: url('https://images.unsplash.com/photo-1587313439340-e070a2d05f3a?q=80&w=2070&auto=format&fit=crop');">
                    <div class="content"><div class="name">Precision Poultry</div><div class="des">Master the 7-week broiler cycle for maximum profitability and efficiency.</div><a href="#broiler-course-page" class="cta-button">Learn More</a></div>
                </div>
                <div class="item" style="background-image: url('https://images.unsplash.com/photo-1598514983318-2f66f174e356?q=80&w=1974&auto=format&fit=crop');">
                    <div class="content"><div class="name">High-Yield Crops</div><div class="des">Unlock secrets to boosting your maize harvest, even in challenging climates.</div><a href="#maize-course-page" class="cta-button">Learn More</a></div>
                </div>
                <div class="item" style="background-image: url('https://images.unsplash.com/photo-1621232353920-7b5a8e3f1e9c?q=80&w=2070&auto=format&fit=crop');">
                    <div class="content"><div class="name">Mushroom Cultivation</div><div class="des">Turn small spaces into profitable ventures by mastering the art of fungi farming.</div><a href="#mushroom-course-page" class="cta-button">Learn More</a></div>
                </div>
                <div class="item" style="background-image: url('https://images.unsplash.com/photo-1597031123922-ac73c48054ac?q=80&w=1931&auto=format&fit=crop');">
                    <div class="content"><div class="name">Aquaculture Mastery</div><div class="des">Learn the science of water quality to build a thriving, sustainable fish farming business.</div><a href="#fish-course-page" class="cta-button">Learn More</a></div>
                </div>
            </div>
            <div class="slider-button"><button class="prev" aria-label="Previous Slide">‚óÅ</button><button class="next" aria-label="Next Slide">‚ñ∑</button></div>
        </section>

        <div id="main-content-area">
             <section id="courses-section" class="container" aria-labelledby="courses-title">
                <div class="section-header">
                    <p class="subtitle">Our Catalog</p><h2 id="courses-title">Featured Courses</h2>
                </div>
                <div class="course-grid"></div>
            </section>
            <!-- Other sections like testimonials, payment, course pages will be inserted here by JS logic or can be added manually -->
        </div>
    </main>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        // --- HERO SLIDER LOGIC ---
        const nextBtn = document.querySelector(".next");
        const prevBtn = document.querySelector(".prev");
        nextBtn.addEventListener("click", () => document.querySelector(".slide").appendChild(document.querySelectorAll(".item")[0]));
        prevBtn.addEventListener("click", () => document.querySelector(".slide").prepend(document.querySelectorAll(".item")[document.querySelectorAll(".item").length - 1]));

        // --- GLOBAL STATE ---
        let currentUser = null, isSubscribed = false, currentAuthMode = 'signin';

        // --- COURSE DATA ---
        const courses = [
            { id: 'broiler-course-page', title: 'Broiler Chicken Rearing', emoji: 'üêî', bgColor: 'rgba(211, 47, 47, 0.2)', shortDesc: '7-Week Profit Cycle. Mastering FCR and Biosecurity.'},
            { id: 'roadrunner-course-page', title: 'Road Runner Chicken Rearing', emoji: 'üèÉ', bgColor: 'rgba(56, 142, 60, 0.2)', shortDesc: 'Indigenous Poultry Management for Premium Markets.'},
            { id: 'mushroom-course-page', title: 'Mushroom Farming', emoji: 'üçÑ', bgColor: 'rgba(0, 105, 92, 0.2)', shortDesc: 'Substrate preparation, sterile spawning, and climate control.'},
            { id: 'fish-course-page', title: 'Fish Farming (Tilapia/Catfish)', emoji: 'üêü', bgColor: 'rgba(25, 118, 210, 0.2)', shortDesc: 'Aquaculture basics: Mastering Dissolved Oxygen (DO).'},
            { id: 'maize-course-page', title: 'Maize Farming', emoji: 'üåΩ', bgColor: 'rgba(251, 192, 45, 0.2)', shortDesc: 'Fertilizer timing, drought mitigation, and maximizing yield.'},
            { id: 'sorghum-course-page', title: 'Sorghum Farming', emoji: 'üåæ', bgColor: 'rgba(103, 58, 183, 0.2)', shortDesc: 'Drought-resistant grain management and pest control.'},
            { id: 'tobacco-course-page', title: 'Tobacco Farming', emoji: 'üåø', bgColor: 'rgba(93, 64, 55, 0.2)', shortDesc: 'High-value crop: Curing techniques and sucker control.'},
        ];

        // --- DOM ELEMENTS CACHE ---
        const elements = {
            hamburger: document.getElementById('hamburger'),
            mobileNav: document.getElementById('mobileNav'),
            mobileNavBackdrop: document.getElementById('mobileNavBackdrop'),
            mobileCoursesToggle: document.getElementById('mobileCoursesToggle'),
            mobileCoursesDropdown: document.getElementById('mobileNav').querySelector('.dropdown-content'),
            desktopCoursesDropdown: document.querySelector('.desktop-nav .dropdown-content'),
            authModal: document.getElementById('authModal'),
            authForm: document.getElementById('authForm'),
            userProfile: document.getElementById('userProfile'),
            userAvatar: document.getElementById('userAvatar'),
            userName: document.getElementById('userName'),
            userActionText: document.getElementById('userActionText'),
            closeAuthModal: document.getElementById('closeAuthModal'),
            authTitle: document.getElementById('authTitle'),
            authSubtitle: document.getElementById('authSubtitle'),
            authSubmitBtn: document.getElementById('authSubmitBtn'),
            authSwitchLink: document.getElementById('authSwitchLink'),
            googleSignInBtn: document.getElementById('googleSignInBtn'),
            usernameGroup: document.getElementById('usernameGroup'),
            mainContentArea: document.getElementById('main-content-area'),
            courseGrid: document.querySelector('.course-grid'),
        };

        // --- INITIALIZATION ---
        function init() {
            if (!window.firebase || !window.firebase.auth) {
                console.error("Firebase is not configured."); return;
            }
            populateCourseGrid();
            populateDropdowns();
            initializeEventListeners();
            firebase.onAuthStateChanged(firebase.auth, handleAuthStateChange);
        }

        function populateCourseGrid() {
            elements.courseGrid.innerHTML = courses.map(course => `
                <a href="#${course.id}" class="course-card" data-target="${course.id}">
                    <div class="card-thumbnail" style="background-color: ${course.bgColor};" role="img" aria-label="${course.title}">${course.emoji}</div>
                    <div class="card-info"><h3>${course.title}</h3><p>${course.shortDesc}</p></div>
                </a>`).join('');
        }
        
        function populateDropdowns() {
            const dropdownHTML = courses.map(course => `<a href="#${course.id}" class="course-link" data-target="${course.id}">${course.title}</a>`).join('');
            elements.desktopCoursesDropdown.innerHTML = dropdownHTML;
            elements.mobileCoursesDropdown.innerHTML = dropdownHTML;
        }

        // --- EVENT LISTENERS ---
        function initializeEventListeners() {
            elements.hamburger.addEventListener('click', toggleMobileMenu);
            elements.mobileNavBackdrop.addEventListener('click', toggleMobileMenu);
            elements.mobileCoursesToggle.addEventListener('click', (e) => { e.preventDefault(); elements.mobileCoursesDropdown.classList.toggle('show'); });
            elements.userProfile.addEventListener('click', () => currentUser ? handleLogout() : openAuthModal());
            elements.closeAuthModal.addEventListener('click', closeAuthModal);
            elements.authModal.addEventListener('click', (e) => e.target === elements.authModal && closeAuthModal());
            elements.authForm.addEventListener('submit', handleAuthSubmit);
            elements.googleSignInBtn.addEventListener('click', handleGoogleSignIn);
            elements.authSwitchLink.addEventListener('click', (e) => { e.preventDefault(); switchAuthMode(); });
            document.body.addEventListener('click', handleNavigation);
        }
        
        function toggleMobileMenu() {
            elements.mobileNav.classList.toggle('active');
            elements.mobileNavBackdrop.classList.toggle('active');
        }

        // --- NAVIGATION & VIEW LOGIC ---
        function handleNavigation(e) {
            let targetLink = e.target.closest('a');
            if (!targetLink || !targetLink.getAttribute('href')?.startsWith('#')) return;
            
            e.preventDefault();
            const targetId = targetLink.getAttribute('href');
            const targetElement = document.querySelector(targetId);

            if (elements.mobileNav.classList.contains('active')) {
                toggleMobileMenu();
            }

            // This is a simplified view logic. For full single-page app behavior,
            // you'd hide/show sections. For this version, we just scroll.
            if (targetElement) {
                 setTimeout(() => targetElement.scrollIntoView({ behavior: 'smooth', block: 'start' }), 300);
            } else if (targetId === '#home-view') {
                 window.scrollTo({ top: 0, behavior: 'smooth' });
            } else {
                // Here you would handle showing the course page or payment page
                console.log("Navigate to dynamic view:", targetId);
                // alert(`Logic to show page for ${targetId} would run here.`);
            }
        }

        // --- AUTHENTICATION LOGIC ---
        function openAuthModal() { elements.authModal.classList.add('active'); }
        function closeAuthModal() { elements.authModal.classList.remove('active'); elements.authForm.reset(); }

        async function handleAuthStateChange(user) {
            if (user) {
                const userDoc = await firebase.getDoc(firebase.doc(firebase.db, "users", user.uid));
                currentUser = userDoc.exists() ? { ...user, ...userDoc.data() } : user;
                isSubscribed = userDoc.exists() ? userDoc.data().subscription || false : false;
            } else {
                currentUser = null; isSubscribed = false;
            }
            updateUIForAuthState();
        }

        function updateUIForAuthState() {
            if (currentUser) {
                const displayName = currentUser.username || currentUser.displayName || 'Farmer';
                elements.userName.textContent = displayName;
                elements.userActionText.textContent = 'Logout';
                if (currentUser.photoURL) {
                    elements.userAvatar.innerHTML = `<img src="${currentUser.photoURL}" alt="${displayName}" style="width:100%; height:100%; border-radius:50%; object-fit:cover;">`;
                } else {
                    elements.userAvatar.innerHTML = displayName.charAt(0).toUpperCase();
                }
            } else {
                elements.userName.textContent = 'Guest';
                elements.userActionText.textContent = 'Login';
                elements.userAvatar.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>`;
            }
            updateCrownIcon();
        }

        function updateCrownIcon() {
            const existingCrown = elements.userProfile.querySelector('.crown-icon');
            if (isSubscribed && !existingCrown) {
                const crown = document.createElement('span');
                crown.className = 'crown-icon'; crown.innerHTML = 'üëë';
                elements.userProfile.prepend(crown);
            } else if (!isSubscribed && existingCrown) {
                existingCrown.remove();
            }
        }

        async function handleAuthSubmit(e) {
            e.preventDefault();
            const email = document.getElementById('authEmail').value;
            const password = document.getElementById('authPassword').value;
            const username = document.getElementById('authUsername').value;
            elements.authSubmitBtn.disabled = true;

            try {
                if (currentAuthMode === 'signup') {
                    if (!username) { alert("Please enter a username."); throw new Error("Username required"); }
                    const userCred = await firebase.createUserWithEmailAndPassword(firebase.auth, email, password);
                    await firebase.updateProfile(userCred.user, { displayName: username });
                    await firebase.setDoc(firebase.doc(firebase.db, 'users', userCred.user.uid), { username, email: userCred.user.email, createdAt: new Date(), subscription: false });
                } else {
                    await firebase.signInWithEmailAndPassword(firebase.auth, email, password);
                }
                closeAuthModal();
            } catch (error) { alert(`Error: ${error.message}`); }
            finally { elements.authSubmitBtn.disabled = false; }
        }

        async function handleGoogleSignIn() {
            try {
                const result = await firebase.signInWithPopup(firebase.auth, firebase.googleProvider);
                const user = result.user;
                const userDocRef = firebase.doc(firebase.db, 'users', user.uid);
                const userDoc = await firebase.getDoc(userDocRef);
                if (!userDoc.exists()) {
                    let username = prompt("Welcome! Please choose a username.", user.displayName.split(' ')[0] || '');
                    if(username) await firebase.setDoc(userDocRef, { username, email: user.email, createdAt: new Date(), subscription: false });
                }
                closeAuthModal();
            } catch (error) { alert(`Google Sign-In Error: ${error.message}`); }
        }
        
        async function handleLogout() {
            if (confirm("Are you sure you want to log out?")) {
                await firebase.signOut(firebase.auth);
            }
        }

        function switchAuthMode() {
            currentAuthMode = currentAuthMode === 'signin' ? 'signup' : 'signin';
            const isSignup = currentAuthMode === 'signup';
            elements.authTitle.textContent = isSignup ? 'Create Account' : 'Welcome Back';
            elements.authSubtitle.textContent = isSignup ? 'Join successful farmers' : 'Sign in to access your courses';
            elements.authSubmitBtn.textContent = isSignup ? 'Create Account' : 'Sign In';
            document.getElementById('authSwitchText').textContent = isSignup ? 'Already have an account?' : "Don't have an account?";
            elements.authSwitchLink.textContent = isSignup ? 'Sign in' : 'Sign up';
            elements.usernameGroup.classList.toggle('hidden', !isSignup);
        }

        init();
    });
    </script>
</body>
</html>
```
